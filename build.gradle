import groovy.json.JsonSlurper

description = 'Mongoose - high-load storage performance testing automation tool'

def loadProjectVersionFrom(String sourceFileName) {
	def inputFile = new File(sourceFileName)
	def json = new JsonSlurper().parseText(inputFile.text)
	json.version
}
def configFilePath = 'defaults.json'

version = loadProjectVersionFrom configFilePath

subprojects {
	apply plugin: 'java'

	version = super.version

	tasks.withType(JavaCompile) {
		sourceCompatibility = JavaVersion.VERSION_1_8
		targetCompatibility = JavaVersion.VERSION_1_8
	}

	task 'create-dirs' << {
		sourceSets*.java.srcDirs*.each { it.mkdirs() }
		sourceSets*.resources.srcDirs*.each { it.mkdirs() }
	}

	repositories {
		mavenCentral()
	}

	dependencies {
		compile 'org.apache.logging.log4j:log4j-core:2.6.1'

		compile 'javax.json:javax.json-api:1.0'
		compile 'org.glassfish:javax.json:1.0.4'

		testCompile 'junit:junit:4.12'
	}
}

task wrapper(type: Wrapper) {
	gradleVersion = '2.14'
}
